"""Test Clinical Evidence function."""

# imports
import pytest 
import logging
import sys
import os

# add path of file
import sys
import os

# Determine the path to startup_utils.py
startup_utils_path = os.path.abspath("app/novelty/gene_nmf/gene_nmf_adapter.py")
startup_utils_dir = os.path.dirname(startup_utils_path)
sys.path.insert(0, startup_utils_dir)
print("added to pyton path the following directory: {}".format(startup_utils_dir))

# import file top test
import app.novelty.gene_nmf.gene_nmf_adapter as adapter
import app.novelty.gene_nmf.dcc.dcc_utils as dutils

# logger
logger = dutils.get_logger(name=__name__)
logger.info("added to pyton path the following directory: {}".format(startup_utils_dir))

# vars
list_gene_test = [
        "NCBIGene:5142",
        "NCBIGene:4853",
        "NCBIGene:4000",
        "NCBIGene:5664",
        "NCBIGene:9804",
        "NCBIGene:22891",
        "NCBIGene:5728",
        "NCBIGene:3087",
        "NCBIGene:5950",
        "NCBIGene:6319",
        "NCBIGene:114815",
        "NCBIGene:6934",
        "NCBIGene:3630",
        "NCBIGene:3784",
        "NCBIGene:3767",
        "NCBIGene:3992",
        "NCBIGene:9415",
        "NCBIGene:7351",
        "NCBIGene:7352",
        "NCBIGene:4544",
        "NCBIGene:10599",
        "NCBIGene:6660",
        "NCBIGene:7480",
        "NCBIGene:8091",
        "NCBIGene:7103",
        "NCBIGene:6927",
        "NCBIGene:2308",
        "NCBIGene:5663",
        "NCBIGene:9369",
        "NCBIGene:4088",
        "NCBIGene:10239",
        "NCBIGene:9055",
        "NCBIGene:79068",
        "NCBIGene:6137",
        "NCBIGene:7157",
        "NCBIGene:6720",
        "NCBIGene:6928",
        "NCBIGene:8877",
        "NCBIGene:9021",
        "NCBIGene:6925",
        "NCBIGene:4160",
        "NCBIGene:3643",
        "NCBIGene:7137",
        "NCBIGene:129787",
        "NCBIGene:338",
        "NCBIGene:2646",
        "NCBIGene:63892",
        "NCBIGene:53335",
        "NCBIGene:5966",
        "NCBIGene:2888",
        "NCBIGene:4760",
        "NCBIGene:3667",
        "NCBIGene:57761",
        "NCBIGene:5335",
        "NCBIGene:3172",
        "NCBIGene:5770",
        "NCBIGene:7022",
        "NCBIGene:7332",
        "NCBIGene:5468",
        "NCBIGene:7325",
        "NCBIGene:7384",
        "NCBIGene:56999",
        "NCBIGene:7018",
        "NCBIGene:285195",
        "NCBIGene:6514",    
        "NCBIGene:10644",
        "NCBIGene:9370",
        "NCBIGene:10296",
        "NCBIGene:7466",
        "NCBIGene:4214",
        "NCBIGene:85480",
        "NCBIGene:6239",
        "NCBIGene:54901",
        "NCBIGene:1432",
        "NCBIGene:7422",
        "NCBIGene:7021",
        "NCBIGene:5314",
        "NCBIGene:222546",
        "NCBIGene:5167",
        "NCBIGene:7128",
        "NCBIGene:387082",
        "NCBIGene:221895",
        "NCBIGene:2645",
        "NCBIGene:5506",
        "NCBIGene:5078",
        "NCBIGene:136259",
        "NCBIGene:79660",
        "NCBIGene:94241",
        "NCBIGene:169026",
        "NCBIGene:7436",
        "NCBIGene:169792",
        "NCBIGene:6194",
        "NCBIGene:140803",
        "NCBIGene:29979",
        "NCBIGene:6812"
    ]

list_genes_600_ars_samples = [
    "NCBIGene:2147",
    "NCBIGene:2147",
    "NCBIGene:472",
    "CHEMBL.TARGET:CHEMBL204",
    "UMLS:C0002313",
    "UMLS:C0002313",
    "NCBIGene:2159",
    "UMLS:C0076566",
    "NCBIGene:3738",
    "UMLS:C0015520",
    "NCBIGene:3736",
    "UMLS:C0016011",
    "UMLS:C0148199",
    "UMLS:C0164786",
    "UMLS:C0600388",
    "NCBIGene:387",
    "MESH:D020778",
    "UMLS:C0031669",
    "NCBIGene:760",
    "UMLS:C0076552",
    "NCBIGene:10899",
    "UMLS:C0086376",
    "NCBIGene:3652",
    "NCBIGene:4846",
    "NCBIGene:2217",
    "MESH:D043265",
    "MESH:D058539",
    "NCBIGene:4887",
    "UMLS:C0031667",
    "UMLS:C0682972",
    "NCBIGene:11196",
    "NCBIGene:55819",
    "NCBIGene:7508",
    "NCBIGene:5074",
    "NCBIGene:4893",
    "MESH:C545445",
    "MESH:D017868",
    "NCBIGene:5898",
    "NCBIGene:4889",
    "UMLS:C0085940",
    "UMLS:C0676301",
    "NCBIGene:967",
    "UMLS:C0072257",
    "NCBIGene:9768",
    "NCBIGene:54808",
    "NCBIGene:3630",
    "NCBIGene:2551",
    "NCBIGene:4886",
    "MESH:D051571",
    "UMLS:C0169101",
    "NCBIGene:820",
    "NCBIGene:5932",
    "NCBIGene:122664",
    "UMLS:C0001492",
    "NCBIGene:90523",
    "NCBIGene:3791",
    "UMLS:C1370600",
    "UMLS:C0061407",
    "NCBIGene:23411",
    "NCBIGene:1667",
    "UMLS:C0055673",
    "NCBIGene:116506",
    "NCBIGene:101054525",
    "NCBIGene:7124",
    "UMLS:C0063710",
    "NCBIGene:7157",
    "UMLS:C0033640",
    "NCBIGene:1958",
    "NCBIGene:58530",
    "CHEMBL.TARGET:CHEMBL204",
    "NCBIGene:7347",
    "UMLS:C3890397",
    "NCBIGene:799",
    "UMLS:C0079073",
    "CHEMBL.TARGET:CHEMBL1075308",
    "UMLS:C0287275",
    "NCBIGene:142",
    "UMLS:C0244989",
    "NCBIGene:1535",
    "NCBIGene:2932",
    "UMLS:C0022709",
    "NCBIGene:3479",
    "NCBIGene:8243",
    "NCBIGene:6335",
    "NCBIGene:102157402",
    "NCBIGene:11186",
    "NCBIGene:4914",
    "NCBIGene:28893",
    "NCBIGene:836",
    "NCBIGene:100996758",
    "NCBIGene:7186",
    "MESH:D020794",
    "NCBIGene:2335",
    "NCBIGene:3569",
    "NCBIGene:3643",
    "UMLS:C0055959",
    "NCBIGene:6646",
    "NCBIGene:6329",
    "NCBIGene:55004",
    "NCBIGene:11200",
    "MESH:C120487",
    "NCBIGene:100689229",
    "NCBIGene:995",
    "NCBIGene:4314",
    "MESH:D053453",
    "NCBIGene:51083",
    "NCBIGene:6750",
    "NCBIGene:6524",
    "NCBIGene:3553",
    "NCBIGene:7099",
    "NCBIGene:5444",
    "NCBIGene:8490",
    "NCBIGene:351",
    "NCBIGene:5972",
    "NCBIGene:1401",
    "NCBIGene:10267",
    "UMLS:C0206454",
    "NCBIGene:10268",
    "NCBIGene:1803",
    "NCBIGene:2151",
    "NCBIGene:9197",
    "UMLS:C0165519",
    "UMLS:C3811720",
    "NCBIGene:3196",
    "NCBIGene:56288",
    "NCBIGene:969",
    "NCBIGene:6517",
    "NCBIGene:2308",
    "NCBIGene:1571",
    "NCBIGene:760",
    "NCBIGene:3290",
    "NCBIGene:4852",
    "MESH:D000262",
    "CHEBI:5931",
    "UNII:8XA4VN1LH4",
    "NCBIGene:252995",
    "NCBIGene:581",
    "NCBIGene:10891",
    "NCBIGene:3375",
    "NCBIGene:4790",
    "MESH:D040281",
    "NCBIGene:4846",
    "NCBIGene:8660",
    "NCBIGene:3552",
    "NCBIGene:7852",
    "NCBIGene:7097",
    "NCBIGene:545",
    "NCBIGene:3060",
    "NCBIGene:2641",
    "NCBIGene:8074",
    "NCBIGene:1906",
    "UMLS:C0248813",
    "NCBIGene:5347",
    "NCBIGene:3818",
    "NCBIGene:1145",
    "NCBIGene:958",
    "NCBIGene:57410",
    "NCBIGene:54",
    "NCBIGene:959",
    "NCBIGene:23424",
    "NCBIGene:1277",
    "NCBIGene:3416",
    "UMLS:C0082529",
    "UMLS:C0378126",
    "NCBIGene:1302",
    "UMLS:C0025250",
    "NCBIGene:5345",
    "NCBIGene:51374",
    "NCBIGene:728358",
    "UMLS:C0166418",
    "UMLS:C0087071",
    "MESH:D051496",
    "MESH:D010730",
    "UMLS:C0006558",
    "MESH:D038362",
    "UMLS:C0036883",
    "UMLS:C0021665",
    "UMLS:C1565154",
    "UMLS:C0038585",
    "MESH:D007376",
    "UMLS:C0074825",
    "NCBIGene:4322",
    "NCBIGene:5468",
    "MESH:D000681",
    "UMLS:C0078067",
    "MESH:D002787",
    "UMLS:C0002521",
    "NCBIGene:3162",
    "NCBIGene:6720",
    "NCBIGene:4313",
    "NCBIGene:3481",
    "NCBIGene:3484",
    "NCBIGene:2660",
    "NCBIGene:632",
    "NCBIGene:6462",
    "NCBIGene:3667",
    "NCBIGene:4929",
    "NCBIGene:8581",
    "NCBIGene:4318",
    "NCBIGene:213",
    "NCBIGene:581",
    "NCBIGene:100125288",
    "NCBIGene:2740",
    "NCBIGene:79813",
    "NCBIGene:3576",
    "NCBIGene:5744",
    "NCBIGene:7433",
    "NCBIGene:10203",
    "NCBIGene:57053",
    "NCBIGene:6515",
    "NCBIGene:1672",
    "NCBIGene:7511",
    "NCBIGene:2475",
    "NCBIGene:5739",
    "NCBIGene:2247",
    "NCBIGene:2258",
    "NCBIGene:5443",
    "NCBIGene:3164",
    "NCBIGene:4294",
    "NCBIGene:6550",
    "NCBIGene:5176",
    "NCBIGene:462",
    "NCBIGene:12",
    "NCBIGene:2161",
    "NCBIGene:3556",
    "MESH:D058539",
    "MESH:D007339",
    "UMLS:C0019018",
    "NCBIGene:820",
    "UMLS:C0389071",
    "MESH:C545445",
    "UMLS:C0017742",
    "UMLS:C0017853",
    "UMLS:C0034783",
    "UMLS:C0078207",
    "UMLS:C0023825",
    "UMLS:C0023820",
    "MESH:C496319",
    "MESH:D007703",
    "UMLS:C0123256",
    "NCBIGene:5294",
    "NCBIGene:5293",
    "NCBIGene:5290",
    "MESH:D024982",
    "NCBIGene:5291",
    "MESH:D015847",
    "CHEBI:15603",
    "UMLS:C0033362",
    "MESH:D005952",
    "UMLS:C0034787",
    "CHEBI:28669",
    "MESH:D017868",
    "UMLS:C0123658",
    "NCBIGene:6855",
    "UMLS:C0024075",
    "NCBIGene:1395",
    "NCBIGene:4353",
    "MESH:D011490",
    "NCBIGene:7422",
    "MESH:D006006",
    "NCBIGene:10628",
    "MESH:D010749",
    "NCBIGene:2538",
    "UMLS:C0034800",
    "UniProtKB:P59665",
    "NCBIGene:2261",
    "NCBIGene:26291",
    "NCBIGene:1950",
    "NCBIGene:338",
    "NCBIGene:9021",
    "NCBIGene:51738",
    "NCBIGene:1557",
    "NCBIGene:2670",
    "NCBIGene:4925",
    "NCBIGene:6755",
    "NCBIGene:8835",
    "NCBIGene:5054",
    "NCBIGene:6752",
    "NCBIGene:57817",
    "NCBIGene:1559",
    "NCBIGene:3091",
    "NCBIGene:2056",
    "UniProtKB:Q8IVG9",
    "NCBIGene:2693",
    "NCBIGene:3717",
    "NCBIGene:3480",
    "NCBIGene:50507",
    "NCBIGene:949",
    "NCBIGene:6776",
    "NCBIGene:5465",
    "NCBIGene:9518",
    "NCBIGene:6777",
    "NCBIGene:1366",
    "NCBIGene:63924",
    "NCBIGene:948",
    "NCBIGene:842",
    "NCBIGene:6774",
    "NCBIGene:2691",
    "NCBIGene:3383",
    "NCBIGene:9370",
    "NCBIGene:2309",
    "NCBIGene:116842",
    "NCBIGene:604",
    "NCBIGene:3814",
    "NCBIGene:1562",
    "NCBIGene:23411",
    "NCBIGene:1392",
    "NCBIGene:6751",
    "NCBIGene:3065",
    "NCBIGene:999",
    "NCBIGene:1325",
    "NCBIGene:8651",
    "NCBIGene:3486",
    "NCBIGene:3558",
    "NCBIGene:2328",
    "NCBIGene:3485",
    "NCBIGene:127845",
    "NCBIGene:50486",
    "NCBIGene:9076",
    "NCBIGene:567",
    "NCBIGene:10054",
    "NCBIGene:185",
    "NCBIGene:8801",
    "NCBIGene:23468",
    "NCBIGene:1268",
    "UMLS:C0170168",
    "NCBIGene:100506365",
    "NCBIGene:6900",
    "NCBIGene:1636",
    "NCBIGene:8445",
    "NCBIGene:6868",
    "NCBIGene:1909",
    "UMLS:C1533585",
    "NCBIGene:79602",
    "NCBIGene:51094",
    "UMLS:C0034785",
    "MESH:D013002",
    "UMLS:C0019878",
    "UMLS:C0061472",
    "UMLS:C0006772",
    "UMLS:C0085151",
    "MESH:C403287",
    "UMLS:C0008731",
    "UMLS:C0023821",
    "NCBIGene:2167",
    "MESH:D018819",
    "UMLS:C0027895",
    "UMLS:C0376180",
    "UMLS:C0071163",
    "MESH:D018664",
    "UMLS:C0061878",
    "UMLS:C0138965",
    "UMLS:C0216510",
    "UMLS:C0079068",
    "UMLS:C0378796",
    "NCBIGene:4780",
    "UMLS:C0082731",
    "NCBIGene:8600",
    "NCBIGene:1671",
    "NCBIGene:2551",
    "NCBIGene:3953",
    "NCBIGene:7080",
    "NCBIGene:6139",
    "NCBIGene:3028",
    "NCBIGene:4780",
    "NCBIGene:4762",
    "NCBIGene:597",
    "NCBIGene:2939",
    "NCBIGene:3605",
    "NCBIGene:5133",
    "NCBIGene:362",
    "NCBIGene:6772",
    "NCBIGene:31",
    "UniProtKB:P0DMV8",
    "NCBIGene:8788",
    "NCBIGene:1576",
    "NCBIGene:6696",
    "NCBIGene:1544",
    "NCBIGene:2146",
    "NCBIGene:5950",
    "NCBIGene:6374",
    "NCBIGene:650",
    "NCBIGene:596",
    "NCBIGene:5781",
    "NCBIGene:3146",
    "NCBIGene:4908",
    "NCBIGene:256933",
    "NCBIGene:335",
    "NCBIGene:6319",
    "NCBIGene:23484",
    "NCBIGene:3175",
    "NCBIGene:5111",
    "NCBIGene:383",
    "NCBIGene:627",
    "NCBIGene:7350",
    "NCBIGene:860",
    "NCBIGene:4287",
    "NCBIGene:7270",
    "NCBIGene:268",
    "NCBIGene:64129",
    "NCBIGene:10135",
    "NCBIGene:6513",
    "NCBIGene:6272",
    "NCBIGene:659",
    "NCBIGene:658",
    "NCBIGene:5346",
    "NCBIGene:208",
    "NCBIGene:50616",
    "NCBIGene:5728",
    "NCBIGene:6523",
    "NCBIGene:2520",
    "NCBIGene:23621",
    "NCBIGene:5433",
    "NCBIGene:257202",
    "NCBIGene:10",
    "NCBIGene:83483",
    "NCBIGene:292",
    "NCBIGene:2882",
    "UniProtKB:O43316",
    "NCBIGene:197",
    "NCBIGene:5594",
    "NCBIGene:5340",
    "NCBIGene:4137",
    "NCBIGene:4982",
    "NCBIGene:2798",
    "UniProtKB:Q92637",
    "NCBIGene:1491",
    "NCBIGene:9420",
    "NCBIGene:23316",
    "NCBIGene:929",
    "NCBIGene:5705",
    "NCBIGene:2690",
    "NCBIGene:7133",
    "NCBIGene:6822",
    "NCBIGene:116",
    "NCBIGene:373156",
    "NCBIGene:1579",
    "NCBIGene:10062",
    "NCBIGene:7042",
    "NCBIGene:1437",
    "NCBIGene:51237",
    "NCBIGene:11200",
    "NCBIGene:947",
    "NCBIGene:3958",
    "NCBIGene:11182",
    "NCBIGene:2052",
    "NCBIGene:5270",
    "NCBIGene:8668",
    "NCBIGene:2064",
    "NCBIGene:1373",
    "NCBIGene:55812",
    "NCBIGene:3488",
    "NCBIGene:1490",
    "NCBIGene:113091",
    "NCBIGene:6387",
    "NCBIGene:4295",
    "NCBIGene:122809",
    "NCBIGene:284273",
    "NCBIGene:30837",
    "NCBIGene:5020",
    "UniProtKB:Q96P88",
    "NCBIGene:27349",
    "NCBIGene:114907",
    "NCBIGene:4089",
    "NCBIGene:3418",
    "NCBIGene:1215",
    "NCBIGene:5329",
    "NCBIGene:6566",
    "NCBIGene:25828",
    "NCBIGene:6783",
    "NCBIGene:51179",
    "NCBIGene:1956",
    "NCBIGene:84883",
    "NCBIGene:56994",
    "NCBIGene:1376",
    "NCBIGene:51651",
    "NCBIGene:56606",
    "NCBIGene:2745",
    "NCBIGene:9757",
    "NCBIGene:4087",
    "NCBIGene:1374",
    "NCBIGene:4656",
    "NCBIGene:2822",
    "NCBIGene:3490",
    "NCBIGene:84312",
    "NCBIGene:10394",
    "NCBIGene:3172",
    "NCBIGene:51343",
    "NCBIGene:30009",
    "NCBIGene:4695",
    "NCBIGene:57104",
    "NCBIGene:28985",
    "NCBIGene:595",
    "NCBIGene:374875",
    "NCBIGene:71",
    "NCBIGene:54886",
    "NCBIGene:4879",
    "NCBIGene:7306",
    "NCBIGene:6514",
    "NCBIGene:24715",
    "NCBIGene:4157",
    "UniProtKB:P04757",
    "NCBIGene:1136",
    "NCBIGene:3105",
    "NCBIGene:5228",
    "NCBIGene:16491",
    "NCBIGene:6530",
    "NCBIGene:10769",
    "PR:000008812",
    "NCBIGene:1758",
    "UniProtKB:P06881-1",
    "NCBIGene:1390",
    "NCBIGene:4312",
    "NCBIGene:7098",
    "NCBIGene:9507",
    "NCBIGene:4133",
    "NCBIGene:23173",
    "NCBIGene:10747",
    "UniProtKB:P0DP23",
    "NCBIGene:10988",
    "NCBIGene:9508",
    "NCBIGene:9988",
    "NCBIGene:7139",
    "NCBIGene:4035",
    "NCBIGene:3099",
    "NCBIGene:5743",
    "NCBIGene:10438",
    "NCBIGene:4513",
    "NCBIGene:8659",
    "NCBIGene:1140",
    "NCBIGene:286",
    "NCBIGene:1267",
    "NCBIGene:5213",
    "NCBIGene:2246",
    "NCBIGene:22926",
    "NCBIGene:7295",
    "NCBIGene:4842",
    "NCBIGene:7076",
    "NCBIGene:6533",
    "NCBIGene:6927",
    "NCBIGene:64849",
    "NCBIGene:5170",
    "NCBIGene:4297",
    "NCBIGene:4148",
    "NCBIGene:58476",
    "NCBIGene:998",
    "NCBIGene:5595",
    "NCBIGene:225689",
    "NCBIGene:3600",
    "NCBIGene:1124",
    "NCBIGene:4359",
    "NCBIGene:23315",
    "NCBIGene:6550",
    "NCBIGene:4987",
    "NCBIGene:8694",
    "NCBIGene:4316",
    "NCBIGene:2002",
    "NCBIGene:5449",
    "NCBIGene:6574",
    "NCBIGene:7421",
    "NCBIGene:896",
    "NCBIGene:6295",
    "NCBIGene:2736",
    "NCBIGene:2264",
    "NCBIGene:203190",
    "NCBIGene:1638",
    "NCBIGene:4763",
    "NCBIGene:10658",
    "NCBIGene:54205",
    "NCBIGene:5774",
    "NCBIGene:445",
    "NCBIGene:255738",
    "NCBIGene:10763",
    "NCBIGene:1548",
    "NCBIGene:6648",
    "NCBIGene:3678",
    "NCBIGene:5617",
    "NCBIGene:4609",
    "NCBIGene:1356",
    "NCBIGene:5319",
    "NCBIGene:885",
    "NCBIGene:7351",
    "NCBIGene:10398",
    "NCBIGene:1019",
    "NCBIGene:54541",
    "NCBIGene:1786",
    "NCBIGene:2950",
    "NCBIGene:1553",
    "NCBIGene:5469",
    "NCBIGene:9232",
    "NCBIGene:54386",
    "NCBIGene:10730",
    "NCBIGene:655",
    "NCBIGene:7352",
    "NCBIGene:9340",
    "NCBIGene:7276",
    "NCBIGene:9056",
    "NCBIGene:1001",
    "NCBIGene:2263",
    "NCBIGene:57338",
    "NCBIGene:931",
    "NCBIGene:7225",
    "NCBIGene:1154",
    "NCBIGene:5320",
    "NCBIGene:1734",
    "NCBIGene:51411",
    "NCBIGene:51",
    "NCBIGene:1549",
    "NCBIGene:2301",
    "NCBIGene:2908",
    "NCBIGene:6037",
    "NCBIGene:60481",
    "NCBIGene:1555",
    "NCBIGene:8501",
    "NCBIGene:5768",
    "NCBIGene:11264",
    "NCBIGene:27342",
    "NCBIGene:3939",
    "NCBIGene:7465",
    "NCBIGene:2861",
    "NCBIGene:2832",
    "NCBIGene:2887",
    "NCBIGene:375748",
    "NCBIGene:3700",
    "NCBIGene:894",
    "NCBIGene:145264",
    "NCBIGene:6857",
    "NCBIGene:84174",
    "NCBIGene:3170"
]

def test_get_gene_nmf_novelty_for_gene_list():
    """
    Test that the gene nmf adaptare novelty function works.
    """
    # initialize
    map_result = {}

    # call method
    map_result = adapter.get_gene_nmf_novelty_for_gene_list(list_input_genes=list_gene_test, log=True)

    # logger
    logger.info("got map result of size: {}".format(len(map_result.get('gene_results'))))

    # test
    assert map_result is not None
    assert map_result.get('gene_results') is not None
    assert len(map_result.get('gene_results')) > 0
    assert len(map_result.get('gene_results')) == len(list_gene_test)



def test_get_gene_nmf_novelty_for_gene_list_and_pvalue():
    """
    Test that the gene nmf adaptare novelty function works.
    """
    # initialize
    map_result = {}

    # call method
    map_result = adapter.get_gene_nmf_novelty_for_gene_list(list_input_genes=list_gene_test, p_value_cutoff=0.2, log=True)

    # logger
    logger.info("got map result of size: {}".format(len(map_result.get('gene_results'))))

    # test
    assert map_result is not None
    assert map_result.get('gene_results') is not None
    assert len(map_result.get('gene_results')) > 0
    assert len(map_result.get('gene_results')) == len(list_gene_test)



def test_get_gene_nmf_novelty_for_gene_list_and_max_gene_sets():
    """
    Test that the gene nmf adaptare novelty function works.
    """
    # initialize
    map_result = {}

    # call method
    map_result = adapter.get_gene_nmf_novelty_for_gene_list(list_input_genes=list_gene_test, max_num_gene_sets=200, log=True)

    # logger
    logger.info("got map result of size: {}".format(len(map_result.get('gene_results'))))

    # test
    assert map_result is not None
    assert map_result.get('gene_results') is not None
    assert len(map_result.get('gene_results')) > 0
    assert len(map_result.get('gene_results')) == len(list_gene_test)


def test_get_gene_nmf_novelty_using_ars_example():
    """
    Test that the gene nmf adaptare novelty function works.
    """
    # initialize
    map_result = {}

    # call method
    map_result = adapter.get_gene_nmf_novelty_for_gene_list(list_input_genes=list_genes_600_ars_samples, p_value_cutoff=0.5, max_num_gene_sets=100, log=True)

    # logger
    logger.info("got map result of size: {}".format(len(map_result.get('gene_results'))))

    # test
    assert map_result is not None
    assert map_result.get('gene_results') is not None
    assert len(map_result.get('gene_results')) > 0
